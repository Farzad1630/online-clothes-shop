USE OnlineShopDB;
GO

CREATE TABLE Users (
    Id INT PRIMARY KEY IDENTITY,
    FullName NVARCHAR(100),
    Email NVARCHAR(100) UNIQUE NOT NULL,
    PasswordHash NVARCHAR(256),
    CreatedAt DATETIME DEFAULT GETDATE()
);
GO

CREATE TABLE Categories (
    Id INT PRIMARY KEY IDENTITY,
    Name NVARCHAR(50)
);
GO

CREATE TABLE Products (
    Id INT PRIMARY KEY IDENTITY,
    Name NVARCHAR(100),
    Description NVARCHAR(MAX),
    Price DECIMAL(18,2),
    DiscountPercent INT DEFAULT 0,
    IsAvailable BIT DEFAULT 1,
    QuantityAvailable INT DEFAULT 0,
    CategoryId INT,
    ImageUrl NVARCHAR(255),
    CreatedAt DATETIME DEFAULT GETDATE(),

    FOREIGN KEY (CategoryId) REFERENCES Categories(Id)
);
GO

CREATE TABLE Wishlists (
    Id INT PRIMARY KEY IDENTITY,
    UserId INT,
    ProductId INT,

    FOREIGN KEY (UserId) REFERENCES Users(Id),
    FOREIGN KEY (ProductId) REFERENCES Products(Id),
    UNIQUE (UserId, ProductId)
);
GO

CREATE TABLE CartItems (
    Id INT PRIMARY KEY IDENTITY,
    UserId INT,
    ProductId INT,
    Quantity INT,

    FOREIGN KEY (UserId) REFERENCES Users(Id),
    FOREIGN KEY (ProductId) REFERENCES Products(Id),
    UNIQUE (UserId, ProductId)
);
GO

CREATE TABLE Orders (
    Id INT PRIMARY KEY IDENTITY,
    UserId INT,
    TotalPrice DECIMAL(18,2),
    Status NVARCHAR(50) DEFAULT 'Pending',
    CreatedAt DATETIME DEFAULT GETDATE(),

    FOREIGN KEY (UserId) REFERENCES Users(Id)
);
GO

CREATE TABLE OrderItems (
    Id INT PRIMARY KEY IDENTITY,
    OrderId INT,
    ProductId INT,
    Quantity INT,
    UnitPrice DECIMAL(18,2),

    FOREIGN KEY (OrderId) REFERENCES Orders(Id),
    FOREIGN KEY (ProductId) REFERENCES Products(Id)
);
GO

CREATE TABLE SpecialOffers (
    Id INT PRIMARY KEY IDENTITY,
    ProductId INT,
    StartDate DATETIME,
    EndDate DATETIME,
    ExtraDiscountPercent INT,

    FOREIGN KEY (ProductId) REFERENCES Products(Id)
);
GO
